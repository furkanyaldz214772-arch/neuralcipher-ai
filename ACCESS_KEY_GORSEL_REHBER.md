# ğŸ”‘ Access Key Nerede? - GÃ¶rsel Rehber

## ğŸ“ Access Key'in Tam Konumu

### Settings SayfasÄ±nda SÄ±ralama:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SETTINGS PAGE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1ï¸âƒ£ ğŸ“¸ Profile Photo                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚  [Drag & drop or click to upload]          â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  2ï¸âƒ£ ğŸ”‘ Access Key Management  â† BURASI!               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚  Your Access Key                            â”‚    â”‚
â”‚     â”‚  Share this key with your doctors           â”‚    â”‚
â”‚     â”‚                                             â”‚    â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚     â”‚  â”‚     ABCD-EFGH-JKLM                    â”‚  â”‚    â”‚
â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚     â”‚                                             â”‚    â”‚
â”‚     â”‚  [ğŸ“‹ Copy Key]  [ğŸ”„ Regenerate]            â”‚    â”‚
â”‚     â”‚                                             â”‚    â”‚
â”‚     â”‚  âš ï¸ Regenerating will revoke all access    â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  3ï¸âƒ£ ğŸ‘¥ Doctors with Access                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚  No doctors have access yet                 â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  4ï¸âƒ£ ğŸ‘¤ Personal Information                           â”‚
â”‚     [First Name] [Last Name]                           â”‚
â”‚     [Date of Birth] [Gender]                           â”‚
â”‚                                                         â”‚
â”‚  5ï¸âƒ£ â¤ï¸ Health Information                             â”‚
â”‚     [Diagnosis Year] [Medications]                     â”‚
â”‚                                                         â”‚
â”‚  6ï¸âƒ£ ğŸ”” Notification Settings                          â”‚
â”‚     â˜‘ï¸ Email notifications                             â”‚
â”‚     â˜‘ï¸ Test reminders                                  â”‚
â”‚                                                         â”‚
â”‚  [ğŸ’¾ Save Changes]                                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Åu Anda Neden GÃ¶rmÃ¼yorsun?

### Senaryo 1: Backend Migration Ã‡alÄ±ÅŸmadÄ± âŒ

**Belirti:**
- Settings sayfasÄ±nda Access Key bÃ¶lÃ¼mÃ¼ hiÃ§ gÃ¶rÃ¼nmÃ¼yor
- Console'da hata var: `Failed to fetch access key`

**Neden:**
- Railway database'de `access_key` kolonu yok
- Backend API hata veriyor
- Frontend key'i gÃ¶steremiyor

**Ã‡Ã¶zÃ¼m:**
```sql
-- Railway Query'de Ã§alÄ±ÅŸtÄ±r:
ALTER TABLE users ADD COLUMN IF NOT EXISTS access_key VARCHAR(20) UNIQUE;
```

### Senaryo 2: Frontend Cache Sorunu ğŸ”„

**Belirti:**
- Backend Ã§alÄ±ÅŸÄ±yor ama frontend eski versiyonu gÃ¶steriyor
- Vercel'de yeni deployment var ama gÃ¶rmÃ¼yorsun

**Ã‡Ã¶zÃ¼m:**
1. Ctrl + Shift + R (Hard refresh)
2. Browser cache temizle
3. Incognito mode'da dene

### Senaryo 3: Authentication Sorunu ğŸ”

**Belirti:**
- Settings sayfasÄ± aÃ§Ä±lÄ±yor ama key yÃ¼klenmiyor
- Console'da 401 Unauthorized hatasÄ±

**Ã‡Ã¶zÃ¼m:**
1. Logout yap
2. Tekrar login ol
3. Settings'e git

---

## ğŸ§ª HÄ±zlÄ± Test - 3 AdÄ±m

### AdÄ±m 1: Backend KontrolÃ¼

Railway Dashboard'da:
```sql
SELECT id, email, access_key 
FROM users 
WHERE role = 'PATIENT' 
LIMIT 5;
```

**Beklenen SonuÃ§:**
```
id | email              | access_key
---+--------------------+---------------
1  | patient@test.com   | ABCD-EFGH-JKLM
2  | hasta@test.com     | WXYZ-1234-5678
```

**EÄŸer `access_key` kolonu yok hatasÄ± alÄ±rsan:**
â†’ Migration Ã§alÄ±ÅŸmamÄ±ÅŸ, Ã§alÄ±ÅŸtÄ±rmamÄ±z gerekiyor

### AdÄ±m 2: API Testi

Browser Console'da (F12):
```javascript
// Token'Ä± al
const token = localStorage.getItem('token')
console.log('Token:', token ? 'Var âœ…' : 'Yok âŒ')

// API'yi test et
fetch('https://web-production-c00b0.up.railway.app/api/v1/profile/access-key', {
  headers: { 'Authorization': `Bearer ${token}` }
})
.then(r => r.json())
.then(data => {
  console.log('âœ… Access Key:', data.access_key)
})
.catch(err => {
  console.error('âŒ Hata:', err)
})
```

**Beklenen SonuÃ§:**
```
âœ… Access Key: ABCD-EFGH-JKLM
```

### AdÄ±m 3: Frontend KontrolÃ¼

Settings sayfasÄ±nda Console'da:
```javascript
// Access key state'ini kontrol et
console.log('Access Key State:', 
  document.querySelector('[class*="text-2xl"]')?.textContent
)
```

**Beklenen SonuÃ§:**
```
Access Key State: ABCD-EFGH-JKLM
```

---

## ğŸ› ï¸ Sorun Giderme AdÄ±mlarÄ±

### Problem: Access Key bÃ¶lÃ¼mÃ¼ hiÃ§ gÃ¶rÃ¼nmÃ¼yor

**Kontrol Et:**
```javascript
// Frontend'de component render oluyor mu?
console.log('Access Key Section:', 
  document.querySelector('h2')?.textContent.includes('Access Key')
)
```

**EÄŸer `false` dÃ¶nerse:**
1. `accessKey` state'i boÅŸ olabilir
2. Conditional rendering Ã§alÄ±ÅŸÄ±yor: `{accessKey && <AccessKeyDisplay />}`
3. Backend'den key gelmiyor

**Ã‡Ã¶zÃ¼m:**
```javascript
// State'i zorla set et (test iÃ§in)
// Settings page'de:
setAccessKey('TEST-1234-5678')
```

### Problem: "LOADING" yazÄ±yor

**Neden:**
- API Ã§aÄŸrÄ±sÄ± hata verdi
- Fallback olarak "LOADING" set edildi

**Ã‡Ã¶zÃ¼m:**
1. Network tab'Ä± aÃ§ (F12)
2. `/api/v1/profile/access-key` isteÄŸini bul
3. Response'u kontrol et
4. Hata varsa backend'i dÃ¼zelt

### Problem: Key var ama kopyalanmÄ±yor

**Kontrol Et:**
```javascript
// Clipboard API Ã§alÄ±ÅŸÄ±yor mu?
navigator.clipboard.writeText('test')
  .then(() => console.log('âœ… Clipboard Ã§alÄ±ÅŸÄ±yor'))
  .catch(err => console.error('âŒ Clipboard hatasÄ±:', err))
```

**EÄŸer hata varsa:**
- HTTPS gerekiyor (localhost'ta Ã§alÄ±ÅŸmaz)
- Browser izni gerekiyor

---

## ğŸ“‹ Checklist - SÄ±rayla Kontrol Et

### âœ… Backend KontrolÃ¼
- [ ] Railway backend Ã§alÄ±ÅŸÄ±yor mu?
- [ ] Database'de `access_key` kolonu var mÄ±?
- [ ] `/api/v1/profile/access-key` endpoint'i Ã§alÄ±ÅŸÄ±yor mu?
- [ ] Test user'Ä±n access_key'i var mÄ±?

### âœ… Frontend KontrolÃ¼
- [ ] Vercel'de son deployment baÅŸarÄ±lÄ± mÄ±?
- [ ] Settings sayfasÄ± aÃ§Ä±lÄ±yor mu?
- [ ] Console'da hata var mÄ±?
- [ ] Token localStorage'da var mÄ±?

### âœ… Network KontrolÃ¼
- [ ] API isteÄŸi gidiyor mu?
- [ ] Response 200 OK mÄ±?
- [ ] Response'da `access_key` var mÄ±?
- [ ] CORS hatasÄ± yok mu?

---

## ğŸš€ HÄ±zlÄ± Ã‡Ã¶zÃ¼m - 5 Dakika

### 1. Railway'e Git (2 dk)
https://railway.app â†’ Backend â†’ Database â†’ Query

```sql
-- Kolon var mÄ± kontrol et
SELECT column_name FROM information_schema.columns 
WHERE table_name = 'users' AND column_name = 'access_key';

-- Yoksa ekle
ALTER TABLE users ADD COLUMN IF NOT EXISTS access_key VARCHAR(20) UNIQUE;

-- Test user'a key ver
UPDATE users 
SET access_key = 'TEST-1234-5678' 
WHERE email = 'patient@test.com';
```

### 2. Backend'i Restart Et (1 dk)
Railway â†’ Backend â†’ Settings â†’ Restart

### 3. Frontend'i Test Et (2 dk)
1. Settings sayfasÄ±nÄ± aÃ§
2. Ctrl + Shift + R (hard refresh)
3. Access Key bÃ¶lÃ¼mÃ¼nÃ¼ gÃ¶r
4. Copy butonunu test et

---

## ğŸ¯ SonuÃ§

**Access Key ÅŸurada olmalÄ±:**
- Settings sayfasÄ±
- Profile Photo'nun hemen altÄ±nda
- Doctors with Access'in hemen Ã¼stÃ¼nde
- BÃ¼yÃ¼k, mavi, XXXX-XXXX-XXXX formatÄ±nda

**GÃ¶rmÃ¼yorsan:**
1. Railway'de migration Ã§alÄ±ÅŸtÄ±r
2. Backend'i restart et
3. Frontend'i hard refresh yap
4. Hala gÃ¶rmÃ¼yorsan Python script'i Ã§alÄ±ÅŸtÄ±r:
   ```bash
   python check_access_key_backend.py
   ```

---

**Not:** Access Key otomatik oluÅŸturulur, manuel bir ÅŸey yapmana gerek yok. Settings'e girdiÄŸin anda backend otomatik key oluÅŸturup dÃ¶ndÃ¼rÃ¼r.
